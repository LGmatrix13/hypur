window.HYPUR={LOADING:!1};function v(){window.HYPUR.LOADING=!0}function l(){window.HYPUR.LOADING=!1}var i={start:v,end:l};var o=new WeakMap;class u{name;base;listeners;defaultState;constructor(t,e,n){this.name=t;let a=n||document.querySelector(`[hypur="${t}"]`);if(!a)throw new Error(`HTMLElement ${t} does not exist`);this.base=a,this.listeners=[],this.defaultState=e,o.set(a,e||{}),document.addEventListener("DOMContentLoaded",async()=>{await Promise.resolve(this.handle())})}get state(){return o.get(this.base)}setState(t){this.state={...this.state,...t(this.state)}}resetState(){this.state=this.defaultState||{}}set state(t){o.set(this.base,t)}innerText(t){this.base.innerText=t}innerHTML(t){this.base.innerHTML=t}outerHTML(t){this.base.outerHTML=t}onEvent(t,e){return this.listeners.push({eventType:t,action:e}),this.base.addEventListener(t,(n)=>{let a=o.get(this.base);e(n,a)}),this}onClick(t){return this.onEvent("click",t)}onChange(t){return this.onEvent("change",t)}onInput(t){return this.onEvent("input",t)}onMouseOver(t){return this.onEvent("mouseover",t)}onMouseOut(t){return this.onEvent("mouseout",t)}onKeyDown(t){return this.onEvent("keydown",t)}onKeyUp(t){return this.onEvent("keyup",t)}async fetcher(t,e){i.start();let n=new URL(window.origin,t),a=await fetch(n,{method:e,body:o.get(this.base)});return i.end(),a}async delete(t,e){let n=await this.fetcher(t,"DELETE");if(e)await Promise.resolve(e(n))}async put(t,e){let n=await this.fetcher(t,"PUT");if(e)await Promise.resolve(e(n))}async post(t,e){let n=await this.fetcher(t,"POST");if(e)await Promise.resolve(e(n))}async get(t,e){let n=await this.fetcher(t,"GET");if(e)await Promise.resolve(e(n))}async hypermedia(t,e){let a=await(await this.fetcher(t,"GET")).text();if(e)await Promise.resolve(e(a))}handle(){}}function T(t,e,n){let a=e.base.cloneNode(!0);if(n)Object.keys(n).forEach((s)=>{let r=a.querySelector(`[hypur="${s}"]`);if(r===null)throw new Error(`Grain of name ${s} could not be found`);r.innerText=n[s]});e.listeners.forEach((s)=>{a.addEventListener(s.eventType,(r)=>s.action(r,n||{}))}),o.set(a,n||{}),t.base.prepend(a)}function m(t,e,n){let a=e.base.cloneNode(!0);a.innerHTML=n,e.listeners.forEach((s)=>{a.addEventListener(s.eventType,(r)=>s.action(r,n||{}))}),o.set(a,n||{}),t.base.prepend(a)}var x={grain:T,hypermedia:m};function S(t,e,n){let a=e.base.cloneNode(!0);if(n)Object.keys(n).forEach((s)=>{let r=a.querySelector(`[hypur="${s}"]`);if(r===null)throw new Error(`Grain of name ${s} could not be found`);r.innerText=n[s]});e.listeners.forEach((s)=>{a.addEventListener(s.eventType,(r)=>s.action(r,n||{}))}),o.set(a,n||{}),t.base.append(a)}function y(t,e,n){let a=e.base.cloneNode(!0);a.innerHTML=n,e.listeners.forEach((s)=>{a.addEventListener(s.eventType,(r)=>s.action(r,n||{}))}),o.set(a,n||{}),t.base.append(a)}var H={grain:S,hypermedia:y};class f{base;constructor(t){let e=document.querySelector(`form[hypur=${t}]`);if(e===null)throw new Error(`HTMLElement ${t} does not exist`);this.base=e,this.base.addEventListener("submit",async(n)=>{n.preventDefault();let a=this.base.getAttribute("method"),s=this.base.getAttribute("action"),r=new FormData(this.base),d={};r.forEach((E,p)=>{d[p]=E});let c=new URL(window.location.origin,s);await Promise.resolve(this.handleData(d));let h=await this.fetcher(c,a,r);await Promise.resolve(this.handleResponse(h))})}async fetcher(t,e,n){i.start();let a=await fetch(t,{method:e,body:n});return i.end(),a}handleData(t){}handleResponse(t){}}var O=window.HYPUR.LOADING;export{o as stateStore,x as prepend,O as loading,H as append,f as GrainForm,u as Grain};

class n extends HTMLElement{onClick(e){}onChange(e){}onInput(e){}onMouseOver(e){}onMouseOut(e){}onKeyDown(e){}onKeyUp(e){}constructor(){super()}async resolver(e,t){try{await e.call(this,t)}catch(o){console.error("Error in handler:",o)}}connectedCallback(){if(n.prototype.onClick!==this.onClick)this.addEventListener("click",async(e)=>{await this.resolver(this.onClick,e)});if(n.prototype.onChange!==this.onChange)this.addEventListener("change",async(e)=>{await this.resolver(this.onChange,e)});if(n.prototype.onInput!==this.onInput)this.addEventListener("input",async(e)=>{await this.resolver(this.onInput,e)});if(n.prototype.onMouseOver!==this.onMouseOver)this.addEventListener("mouseover",async(e)=>{await this.resolver(this.onMouseOver,e)});if(n.prototype.onMouseOut!==this.onMouseOut)this.addEventListener("mouseout",async(e)=>{await this.resolver(this.onMouseOut,e)});if(n.prototype.onKeyDown!==this.onKeyDown)this.addEventListener("keydown",async(e)=>{await this.resolver(this.onKeyDown,e)});if(n.prototype.onKeyUp!==this.onKeyUp)this.addEventListener("keyup",async(e)=>{await this.resolver(this.onKeyUp,e)})}disconnectedCallback(){if(n.prototype.onClick!==this.onClick)this.removeEventListener("click",this.onClick.bind(this));if(n.prototype.onChange!==this.onChange)this.removeEventListener("change",this.onChange.bind(this));if(n.prototype.onInput!==this.onInput)this.removeEventListener("input",this.onInput.bind(this));if(n.prototype.onMouseOver!==this.onMouseOver)this.removeEventListener("mouseover",this.onMouseOver.bind(this));if(n.prototype.onMouseOut!==this.onMouseOut)this.removeEventListener("mouseout",this.onMouseOut.bind(this));if(n.prototype.onKeyDown!==this.onKeyDown)this.removeEventListener("keydown",this.onKeyDown.bind(this));if(n.prototype.onKeyUp!==this.onKeyUp)this.removeEventListener("keyup",this.onKeyUp.bind(this))}static mount(e,t){customElements.define(e,t)}}var m={};class i{static within(e,t){let o=e.querySelector(`[sow="${t}"]`);if(!o)throw new Error(`No Grain of name ${t} found within requested element`);return o}static last(e){let t=Array.from(document.querySelectorAll(`[sow="${e}"]`));if(!t.length)throw new Error(`No Grain of name ${e} could be found`);return t[t.length-1]}static first(e){return i.find(e)}static all(e){let t=Array.from(document.querySelectorAll(`[sow="${e}"]`));if(!t.length)throw new Error(`Sow could not find ${e}`);return t}static append(e,t){e.append(t)}static prepend(e,t){e.prepend(t)}static clone(e){return e.cloneNode(!0)}static find(e){let t=document.querySelector(`[sow="${e}"]`);if(!t)throw new Error(`Sow could not find ${e}`);return t}static snapshot(e){let t=i.find(e).cloneNode(!0);m[e]=t}static template(e){let t=document.querySelector(`template[sow="${e}"]`);if(!t)throw new Error(`Sow could not find template ${t}`);return t}static restore(e){let t=m[e];if(!t)throw new Error(`Sow could not find snapshot ${e}`);return delete m[e],t}static delay(e){return new Promise((t)=>setTimeout(t,e))}static spread(e,t){Object.keys(t).forEach((o)=>{let s=e.querySelector(`[sow="${o}"]`);if(!s){let d=e.querySelector(o);if(!d)throw new Error(`Sow of name ${o} could not be found`);d.innerText=t[o]}else s.innerText=t[o]})}static remove(e){e.remove()}static async fetcher(e,t,o){let s=new URL(e,window.origin);return await fetch(s,{method:t,body:JSON.stringify(o)})}static async delete(e,t,o){let s=await i.fetcher(e,"DELETE",t);if(o)await Promise.resolve(o(s))}static async put(e,t,o){let s=await i.fetcher(e,"PUT",t);if(o)await Promise.resolve(o(s))}static async post(e,t,o){let s=await i.fetcher(e,"POST",t);if(o)await Promise.resolve(o(s))}static async get(e,t,o){let s=await i.fetcher(e,"GET",t);if(o)await Promise.resolve(o(s))}static async hypermedia(e,t,o,s){let l=await(await i.fetcher(e,t,o)).text();if(s)await Promise.resolve(s(l))}}class h extends n{state={};constructor(){super()}async delete(e,t){await i.delete(e,this.state,t)}async put(e,t){await i.put(e,this.state,t)}async post(e,t){await i.post(e,this.state,t)}async get(e,t){await i.get(e,this.state,t)}async hypermedia(e,t,o){await i.hypermedia(e,t,this.state,o)}}class p extends HTMLElement{constructor(){super();let e=this.querySelector("form");if(e)e.addEventListener("submit",async(t)=>{t.preventDefault();let o=e.getAttribute("method"),s=e.getAttribute("action"),d=this.querySelectorAll("input"),l=this.querySelectorAll("textarea"),c={};if(d.forEach((r)=>{let a=null;switch(r.type){case"number":a=Number(r.value);break;default:a=r.value}c[r.name]=a}),l.forEach((r)=>{let a=null;switch(r.type){case"number":a=Number(r.value);break;default:a=r.value}c[r.name]=a}),o&&s){let r=await Promise.resolve(this.beforeSubmit(c));await Promise.resolve(this.onSubmit(r));let a=await this.fetcher(s,o,r);await Promise.resolve(this.afterSubmit(a))}else{let r=await Promise.resolve(this.beforeSubmit(c));await Promise.resolve(this.onSubmit(r))}})}async fetcher(e,t,o){return await fetch(e,{method:t,body:JSON.stringify(o)})}reset(){let e=this.querySelector("form");if(e)e.reset()}beforeSubmit(e){return e}onSubmit(e){}afterSubmit(e){}static mount(e,t){customElements.define(e,t)}}class u{key;constructor(e,t){if(this.key=e,!window.HYPUR_CONTEXT)window.HYPUR_CONTEXT={};if(!window.HYPUR_CONTEXT[e])window.HYPUR_CONTEXT[e]=t}get(){return window.HYPUR_CONTEXT[this.key]}set(e){window.HYPUR_CONTEXT[this.key]=e}clear(){delete window.HYPUR_CONTEXT[this.key]}}class v{key;constructor(e,t){if(this.key=e,!window.localStorage.getItem(e))window.localStorage.setItem(`HYPUR_PERSISTANT_CONTEXT_${e}`,JSON.stringify(t))}get(){let e=window.localStorage.getItem(`HYPUR_PERSISTANT_CONTEXT_${this.key}`);if(!e)throw new Error(`No item in PersistantContext with key ${this.key}`);return JSON.parse(e)}set(e){window.localStorage.setItem(`HYPUR_PERSISTANT_CONTEXT_${this.key}`,JSON.stringify(e))}clear(){window.localStorage.removeItem(`HYPUR_PERSISTANT_CONTEXT_${this.key}`)}}export{h as StatefulGrain,i as Sow,v as PersistantContext,n as Grain,p as FormGrain,u as Context};
